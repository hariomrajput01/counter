<!DOCTYPE html>
<html lang="hi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>राधे राधे काउंटर</title>
  <style>
    :root{
      --bg: #0f172a;
      --card: #0b1220;
      --accent: #75c7ec;
      --muted: #94a3b8;
      --glass: rgba(255,255,255,0.04);
    }
    *{box-sizing:border-box;font-family:Inter, "Noto Sans Devanagari", system-ui,Segoe UI,Roboto,Arial; color: #e6eef8}
    body{
      margin:0;
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      background:linear-gradient(180deg,#071024 0%, #081028 100%);
      padding:20px;
    }
    .card{
      width:380px;
      max-width:96vw;
      background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border-radius:16px;
      padding:20px;
      box-shadow: 0 8px 30px rgba(2,6,23,0.6);
      border:1px solid rgba(255,255,255,0.03);
    }
    .title{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
    }
    h1{font-size:20px;margin:0}
    .muted{color:var(--muted);font-size:13px}
    .count{
      margin-top:18px;
      font-size:48px;
      text-align:center;
      font-weight:700;
      letter-spacing:1px;
    }
    .controls{
      display:flex;
      gap:10px;
      margin-top:18px;
    }
    button{
      flex:1;
      padding:14px 12px;
      border-radius:12px;
      background:var(--glass);
      border:1px solid rgba(255,255,255,0.03);
      color:inherit;
      font-weight:600;
      cursor:pointer;
      user-select:none;
    }
    button.primary{
      background:linear-gradient(90deg,#ffd166,#ff9f1c);
      color:#071022;
      box-shadow: 0 6px 18px rgba(255,157,60,0.18);
    }
    .small{
      padding:8px 10px;
      font-size:13px;
      border-radius:10px;
    }
    .row{
      display:flex;
      gap:8px;
      margin-top:12px;
      align-items:center;
      justify-content:space-between;
    }
    .muted-block{
      background: rgba(255,255,255,0.02);
      padding:10px;
      border-radius:10px;
      font-size:13px;
      color:var(--muted);
    }
    .footer{
      margin-top:14px;
      display:flex;
      gap:8px;
      justify-content:space-between;
      align-items:center;
    }
    .link{
      background:transparent;
      border:1px dashed rgba(255,255,255,0.04);
      padding:8px 10px;
      border-radius:10px;
      font-size:13px;
      cursor:pointer;
    }

    /* modal */
    .modal-backdrop{
      position:fixed;
      inset:0;
      display:none;
      align-items:center;
      justify-content:center;
      background:rgba(2,6,23,0.6);
      z-index:50;
    }
    .modal{
      width:320px;
      background:linear-gradient(180deg,#081226,#071021);
      border-radius:12px;
      padding:16px;
      border:1px solid rgba(255,255,255,0.03);
    }
    .modal h3{margin:0 0 10px 0}
    .field{display:flex;flex-direction:column;gap:6px;margin-bottom:10px}
    input[type="number"], input[type="text"]{
      padding:8px 10px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit;
    }
    .hint{font-size:12px;color:var(--muted)}
    .hidden{display:none}
    .big-note{font-size:12px;color:var(--muted);margin-top:8px;text-align:center}
  </style>
</head>
<body>
  <div class="card" role="application" aria-label="Radhey Radhey Counter">
    <div class="title">
      <div>
        <h1>राधे राधे काउंटर</h1>
        <div class="muted">एक-बार क्लिक करें — हर क्लिक गिनती बढ़ेगी</div>
      </div>
      <div>
        <button id="settingsBtn" class="small">शर्तें ⚙️</button>
      </div>
    </div>

    <div class="count" id="countDisplay" aria-live="polite">0</div>

    <div class="row">
      <div class="muted-block">लक्ष्य: <strong id="maxLabel">100000</strong></div>
      <div class="muted-block">सेव: <span id="savedIndicator">--</span></div>
    </div>

    <div class="controls">
      <!-- Main tap button with Hindi text -->
      <button id="tapBtn" class="primary" aria-pressed="false" aria-label="राधे राधे बटन">राधे राधे</button>
      <button id="resetBtn" title="रीस्टार्ट">रीस्टार्ट</button>
    </div>

    <div class="row" style="margin-top:12px">
      <button id="saveBtn" class="link">लोकल सेव</button>
      <button id="shareBtn" class="link">शेयर</button>
    </div>

    <div class="footer">
      <div class="muted small">कीबोर्ड: Space या Enter से टैप करे</div>
      <div>
        <button id="downloadBtn" class="small">डाउनलोड</button>
      </div>
    </div>
  </div>

  <!-- Settings modal -->
  <div class="modal-backdrop" id="modalBackdrop" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="modal">
      <h3>शर्तें (Settings)</h3>
      <div class="field">
        <label>अधिकतम गिनती (Max count)</label>
        <input id="maxInput" type="number" min="1" value="100000" />
        <div class="hint">डिफ़ॉल्ट 100000 — आप बदल सकते हैं</div>
      </div>
      <div class="field">
        <label>काउंटर का नाम (Optional)</label>
        <input id="nameInput" type="text" placeholder="उदा. माला" />
      </div>
      <div style="display:flex;gap:8px;justify-content:flex-end">
        <button id="closeSettings" class="link">रद्द</button>
        <button id="saveSettings" class="primary">सहेजें</button>
      </div>
      <div class="big-note">सेव करने पर नए विकल्प लोकल स्टोरेज में सुरक्षित रहेंगे।</div>
    </div>
  </div>

  <script>
    // Elements
    const tapBtn = document.getElementById('tapBtn');
    const countDisplay = document.getElementById('countDisplay');
    const resetBtn = document.getElementById('resetBtn');
    const saveBtn = document.getElementById('saveBtn');
    const shareBtn = document.getElementById('shareBtn');
    const downloadBtn = document.getElementById('downloadBtn');
    const savedIndicator = document.getElementById('savedIndicator');
    const maxLabel = document.getElementById('maxLabel');

    const modalBackdrop = document.getElementById('modalBackdrop');
    const settingsBtn = document.getElementById('settingsBtn');
    const closeSettings = document.getElementById('closeSettings');
    const saveSettings = document.getElementById('saveSettings');
    const maxInput = document.getElementById('maxInput');
    const nameInput = document.getElementById('nameInput');

    // State - load from localStorage if exists
    const LS_KEY = 'radhe_counter_v1';
    let state = {
      count: 0,
      max: 100000,
      name: ''
    };

    function loadState(){
      try{
        const raw = localStorage.getItem(LS_KEY);
        if(raw){
          const data = JSON.parse(raw);
          if(typeof data.count === 'number') state.count = data.count;
          if(typeof data.max === 'number') state.max = data.max;
          if(typeof data.name === 'string') state.name = data.name;
        }
      }catch(e){
        console.warn('load error', e);
      }
      updateUI();
    }

    function saveState(){
      try{
        localStorage.setItem(LS_KEY, JSON.stringify(state));
        savedIndicator.textContent = new Date().toLocaleTimeString();
      }catch(e){
        console.warn('save error', e);
      }
    }

    function updateUI(){
      countDisplay.textContent = state.count.toLocaleString('en-IN');
      maxLabel.textContent = state.max.toLocaleString('en-IN');
      maxInput.value = state.max;
      nameInput.value = state.name || '';
      // disable tap if reached max
      if(state.count >= state.max){
        tapBtn.disabled = true;
        tapBtn.setAttribute('aria-pressed','true');
        tapBtn.textContent = 'पूरा हुआ';
      } else {
        tapBtn.disabled = false;
        tapBtn.setAttribute('aria-pressed','false');
        tapBtn.textContent = 'राधे राधे';
      }
    }

    // increment function
    function increment(){
      if(state.count >= state.max) return;
      state.count += 1;
      updateUI();
      // optional autosave every 50 clicks
      if(state.count % 50 === 0) saveState();
    }

    // events
    tapBtn.addEventListener('click', () => {
      increment();
    });

    // keyboard: space or enter while focused anywhere should increment
    window.addEventListener('keydown', (e) => {
      // ignore if in input field
      const tag = (e.target && e.target.tagName) || '';
      if(tag === 'INPUT' || tag === 'TEXTAREA') return;
      if(e.code === 'Space' || e.code === 'Enter'){
        e.preventDefault();
        increment();
      }
    });

    resetBtn.addEventListener('click', () => {
      if(confirm('क्या आप काउंटर रीसेट (0) करना चाहते हैं?')) {
        state.count = 0;
        saveState();
        updateUI();
      }
    });

    saveBtn.addEventListener('click', () => {
      saveState();
      alert('लोकल स्टोरेज में सेव किया गया।');
    });

    // download snapshot JSON
    downloadBtn.addEventListener('click', () => {
      const data = {
        name: state.name || 'राधे-काउंटर',
        count: state.count,
        max: state.max,
        savedAt: new Date().toISOString()
      };
      const blob = new Blob([JSON.stringify(data, null, 2)], {type: 'application/json'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `${(state.name||'radhe-counter')}-${Date.now()}.json`;
      document.body.appendChild(a);
      a.click();
      a.remove();
      URL.revokeObjectURL(url);
    });

    // sharing: use Web Share API if available else fallback to copy text
    shareBtn.addEventListener('click', async () => {
      const shareText = `${state.name || 'राधे राधे'}: ${state.count} / ${state.max}\n-- राधे राधे काउंटर --`;
      if(navigator.share){
        try{
          await navigator.share({
            title: state.name || 'राधे राधे काउंटर',
            text: shareText
          });
        }catch(e){
          // user cancelled
        }
      } else if(navigator.clipboard){
        try{
          await navigator.clipboard.writeText(shareText);
          alert('काउंटर टेक्स्ट क्लिपबोर्ड में कॉपी कर दिया गया। आप अब कहीं भी पेस्ट कर सकते हैं।');
        }catch(e){
          alert('क्लिपबोर्ड एक्सेस नहीं — नीचे टेक्स्ट को कॉपी करें:\n\n' + shareText);
        }
      } else {
        alert('Share समर्थित नहीं — यहाँ टेक्स्ट कॉपी करो:\n\n' + shareText);
      }
    });

    // Settings modal logic
    settingsBtn.addEventListener('click', () => {
      modalBackdrop.style.display = 'flex';
      modalBackdrop.setAttribute('aria-hidden','false');
      maxInput.focus();
    });
    closeSettings.addEventListener('click', () => {
      modalBackdrop.style.display = 'none';
      modalBackdrop.setAttribute('aria-hidden','true');
    });
    saveSettings.addEventListener('click', () => {
      const newMax = parseInt(maxInput.value || '100000', 10);
      const newName = nameInput.value.trim();
      if(isNaN(newMax) || newMax < 1){
        alert('कृपया मान्य अधिकतम संख्या डालें (1 या उससे अधिक)।');
        return;
      }
      state.max = newMax;
      state.name = newName;
      // if current count > new max => clamp
      if(state.count > state.max) state.count = state.max;
      saveState();
      updateUI();
      modalBackdrop.style.display = 'none';
      modalBackdrop.setAttribute('aria-hidden','true');
    });

    // click outside modal to close
    modalBackdrop.addEventListener('click', (e) => {
      if(e.target === modalBackdrop){
        modalBackdrop.style.display = 'none';
        modalBackdrop.setAttribute('aria-hidden','true');
      }
    });

    // initialize
    loadState();

    // auto-save on unload
    window.addEventListener('beforeunload', () => {
      saveState();
    });
  </script>
</body>
</html>
